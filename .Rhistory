max_agents = 20
alpha = 0.2
integ <-function(x,P){(P-1)*(x^(P-1))/(1 - (x^(P-1)))}
Tau <- function(w,N){
if(N==1){
return(0)
}
else{
return((1- alpha)*(integrate(integ, lower= 0, upper= w, P = N)$value))
}
}
Payments <- unlist(lapply(W,Tau, N = N))
SimulateVCG <- function(W, alpha){
winner <- which.max(W)
copy_W <- W
copy_W[winner] = 0
transfer <- (1- alpha)*max(copy_W)
social_welfare = sum(copy_W*alpha) + W[winner] - transfer
res = c(winner, W[winner], transfer, social_welfare)
return(res)
}
SimulateRandom <- function(W, alpha){
winner <- sample(1:length(W),1)
copy_W <- W
copy_W[winner] = 0
social_welfare = sum(copy_W*alpha) + W[winner]
res = c(winner, W[winner], social_welfare)
return(res)
}
SimulateWOA <- function(W, alpha){
agents <- length(W)
winner <- which.max(W)
copy_W <- W
copy_W[winner] = 0
transfer <- unlist(lapply(W,Tau, N = agents))
social_welfare = sum(copy_W*alpha) + W[winner] - sum(transfer)
res = c(winner, W[winner], transfer[winner], sum(transfer), social_welfare)
return(res)
}
Simulatescenario <- function(W,alpha){
VCG <- SimulateVCG(W,alpha)
Random <- SimulateRandom(W,alpha)
WOA <- SimulateWOA(W,alpha)
res <- c(VCG[4], Random[3], WOA[5])
return(res)
}
SW_VCG = c()
SW_Random = c()
SW_WOA = c()
for (n in 1:max_agents){
data = c()
for (rep in 1:1000){
N = n
W <- runif(N)
res <- Simulatescenario(W,alpha)
data <- rbind(data, res)
}
data_mean <- colMeans(data)
SW_VCG = c(SW_VCG, data_mean[1])
SW_Random = c(SW_Random, data_mean[2])
SW_WOA = c(SW_Random, data_mean[3])
}
plot(1:max_agents,SW_VCG, col="blue", pch="o", lty=1)
points(SW_Random, pch="x", col="red", lty=1)
points(SW_WOA, pch="+", col="green")
max_agents = 30
SW_VCG = c()
SW_Random = c()
SW_WOA = c()
for (n in 1:max_agents){
data = c()
for (rep in 1:1000){
N = n
W <- runif(N)
res <- Simulatescenario(W,alpha)
data <- rbind(data, res)
}
data_mean <- colMeans(data)
SW_VCG = c(SW_VCG, data_mean[1])
SW_Random = c(SW_Random, data_mean[2])
SW_WOA = c(SW_Random, data_mean[3])
}
for (n in 1:max_agents){
data = c()
for (rep in 1:1000){
N = n
W <- runif(N)
res <- Simulatescenario(W,alpha)
data <- rbind(data, res)
}
data_mean <- colMeans(data)
SW_VCG = c(SW_VCG, data_mean[1])
SW_Random = c(SW_Random, data_mean[2])
SW_WOA = c(SW_WOA, data_mean[3])
}
SW_VCG = c()
SW_Random = c()
SW_WOA = c()
for (n in 1:max_agents){
data = c()
for (rep in 1:1000){
N = n
W <- runif(N)
res <- Simulatescenario(W,alpha)
data <- rbind(data, res)
}
data_mean <- colMeans(data)
SW_VCG = c(SW_VCG, data_mean[1])
SW_Random = c(SW_Random, data_mean[2])
SW_WOA = c(SW_WOA, data_mean[3])
}
plot(1:max_agents,SW_VCG, col="blue", pch="o", lty=1)
points(SW_Random, pch="x", col="red", lty=1)
points(SW_WOA, pch="+", col="green")
max_agents = 50
SW_VCG = c()
SW_Random = c()
SW_WOA = c()
for (n in 1:max_agents){
data = c()
for (rep in 1:100){
N = n
W <- runif(N)
res <- Simulatescenario(W,alpha)
data <- rbind(data, res)
}
data_mean <- colMeans(data)
SW_VCG = c(SW_VCG, data_mean[1])
SW_Random = c(SW_Random, data_mean[2])
SW_WOA = c(SW_WOA, data_mean[3])
}
plot(1:max_agents,SW_VCG, col="blue", pch="o", lty=1)
points(SW_Random, pch="x", col="red", lty=1)
points(SW_WOA, pch="+", col="green")
SW_VCG
plot(1:max_agents,SW_VCG, col="blue", pch="o", lty=1, ylim = c(-0.5, max_agents/10 + 1))
points(SW_Random, pch="x", col="red", lty=1)
points(SW_WOA, pch="+", col="green")
max_agents = 50
SW_VCG = c()
SW_Random = c()
SW_WOA = c()
for (n in 1:max_agents){
data = c()
for (rep in 1:100){
N = n
W <- runif(N)
sum(W)
res <- Simulatescenario(W,alpha)
data <- rbind(data, res)
}
data_mean <- colMeans(data)
SW_VCG = c(SW_VCG, data_mean[1])
SW_Random = c(SW_Random, data_mean[2])
SW_WOA = c(SW_WOA, data_mean[3])
}
max_agents = 50
SW_VCG = c()
SW_Random = c()
SW_WOA = c()
for (n in 1:max_agents){
data = c()
for (rep in 1:100){
N = n
W <- runif(N)
print(sum(W))
res <- Simulatescenario(W,alpha)
data <- rbind(data, res)
}
data_mean <- colMeans(data)
SW_VCG = c(SW_VCG, data_mean[1])
SW_Random = c(SW_Random, data_mean[2])
SW_WOA = c(SW_WOA, data_mean[3])
}
View(data)
View(data)
for (n in 1:max_agents){
data = c()
for (rep in 1:100){
N = n
W <- runif(N)
res <- Simulatescenario(W,alpha)
data <- rbind(data, res)
}
print(sum(W))
data_mean <- colMeans(data)
SW_VCG = c(SW_VCG, data_mean[1])
SW_Random = c(SW_Random, data_mean[2])
SW_WOA = c(SW_WOA, data_mean[3])
}
alpha = 0.98
max_agents = 50
SW_VCG = c()
SW_Random = c()
SW_WOA = c()
for (n in 1:max_agents){
data = c()
for (rep in 1:100){
N = n
W <- runif(N)
res <- Simulatescenario(W,alpha)
data <- rbind(data, res)
}
print(sum(W))
data_mean <- colMeans(data)
SW_VCG = c(SW_VCG, data_mean[1])
SW_Random = c(SW_Random, data_mean[2])
SW_WOA = c(SW_WOA, data_mean[3])
}
plot(1:max_agents,SW_VCG, col="blue", pch="o", lty=1, ylim = c(-0.5, max_agents/10 + 1))
points(SW_Random, pch="x", col="red", lty=1)
points(SW_WOA, pch="+", col="green")
plot(1:max_agents,SW_VCG, col="blue", pch="o", lty=1)
points(SW_Random, pch="x", col="red", lty=1)
points(SW_WOA, pch="+", col="green")
alpha = 0.4
max_agents = 50
SW_VCG = c()
SW_Random = c()
SW_WOA = c()
for (n in 1:max_agents){
data = c()
for (rep in 1:100){
N = n
W <- runif(N)
res <- Simulatescenario(W,alpha)
data <- rbind(data, res)
}
print(sum(W))
data_mean <- colMeans(data)
SW_VCG = c(SW_VCG, data_mean[1])
SW_Random = c(SW_Random, data_mean[2])
SW_WOA = c(SW_WOA, data_mean[3])
}
plot(1:max_agents,SW_VCG, col="blue", pch="o", lty=1)
points(SW_Random, pch="x", col="red", lty=1)
points(SW_WOA, pch="+", col="green")
alpha = 0.1
max_agents = 50
SW_VCG = c()
SW_Random = c()
SW_WOA = c()
for (n in 1:max_agents){
data = c()
for (rep in 1:100){
N = n
W <- runif(N)
res <- Simulatescenario(W,alpha)
data <- rbind(data, res)
}
print(alpha*sum(W))
data_mean <- colMeans(data)
SW_VCG = c(SW_VCG, data_mean[1])
SW_Random = c(SW_Random, data_mean[2])
SW_WOA = c(SW_WOA, data_mean[3])
}
plot(1:max_agents,SW_VCG, col="blue", pch="o", lty=1)
points(SW_Random, pch="x", col="red", lty=1)
points(SW_WOA, pch="+", col="green")
alpha = 0
max_agents = 50
SW_VCG = c()
SW_Random = c()
SW_WOA = c()
for (n in 1:max_agents){
data = c()
for (rep in 1:100){
N = n
W <- runif(N)
res <- Simulatescenario(W,alpha)
data <- rbind(data, res)
}
print(alpha*sum(W))
data_mean <- colMeans(data)
SW_VCG = c(SW_VCG, data_mean[1])
SW_Random = c(SW_Random, data_mean[2])
SW_WOA = c(SW_WOA, data_mean[3])
}
plot(1:max_agents,SW_VCG, col="blue", pch="o", lty=1)
points(SW_Random, pch="x", col="red", lty=1)
points(SW_WOA, pch="+", col="green")
plot(1:max_agents,SW_VCG, col="blue", pch="o", lty=1, ylim = c(0, 1))
points(SW_Random, pch="x", col="red", lty=1)
points(SW_WOA, pch="+", col="green")
plot(1:max_agents,SW_VCG, col="blue", pch="o", lty=1, ylim = c(-1, 1))
points(SW_Random, pch="x", col="red", lty=1)
points(SW_WOA, pch="+", col="green")
alpha = 0.05
max_agents = 50
SW_VCG = c()
SW_Random = c()
SW_WOA = c()
for (n in 1:max_agents){
data = c()
for (rep in 1:100){
N = n
W <- runif(N)
res <- Simulatescenario(W,alpha)
data <- rbind(data, res)
}
print(alpha*sum(W))
data_mean <- colMeans(data)
SW_VCG = c(SW_VCG, data_mean[1])
SW_Random = c(SW_Random, data_mean[2])
SW_WOA = c(SW_WOA, data_mean[3])
}
plot(1:max_agents,SW_VCG, col="blue", pch="o", lty=1, ylim = c(-1, 1))
points(SW_Random, pch="x", col="red", lty=1)
points(SW_WOA, pch="+", col="green")
alpha = 0.3
integ <-function(x,P){(P-1)*(x^(P-1))/(1 - (x^(P-1)))}
Tau <- function(w,N){
if(N==1){
return(0)
}
else{
return((1- alpha)*(integrate(integ, lower= 0, upper= w, P = N)$value))
}
}
max_agents = 50
SW_VCG = c()
SW_Random = c()
SW_WOA = c()
for (n in 1:max_agents){
data = c()
for (rep in 1:100){
N = n
W <- runif(N)
res <- Simulatescenario(W,alpha)
data <- rbind(data, res)
}
print(alpha*sum(W))
data_mean <- colMeans(data)
SW_VCG = c(SW_VCG, data_mean[1])
SW_Random = c(SW_Random, data_mean[2])
SW_WOA = c(SW_WOA, data_mean[3])
}
plot(1:max_agents,SW_VCG, col="blue", pch="o", lty=1, ylim = c(-1, 1))
points(SW_Random, pch="x", col="red", lty=1)
points(SW_WOA, pch="+", col="green")
plot(1:max_agents,SW_VCG, col="blue", pch="o", lty=1, ylim = c(0, 10))
points(SW_Random, pch="x", col="red", lty=1)
points(SW_WOA, pch="+", col="green")
alpha = 0
integ <-function(x,P){(P-1)*(x^(P-1))/(1 - (x^(P-1)))}
Tau <- function(w,N){
if(N==1){
return(0)
}
else{
return((1- alpha)*(integrate(integ, lower= 0, upper= w, P = N)$value))
}
}
SimulateVCG <- function(W, alpha){
winner <- which.max(W)
copy_W <- W
copy_W[winner] = 0
transfer <- (1- alpha)*max(copy_W)
social_welfare = sum(copy_W*alpha) + W[winner] - transfer
res = c(winner, W[winner], transfer, social_welfare)
return(res)
}
SimulateRandom <- function(W, alpha){
winner <- sample(1:length(W),1)
copy_W <- W
copy_W[winner] = 0
social_welfare = sum(copy_W*alpha) + W[winner]
res = c(winner, W[winner], social_welfare)
return(res)
}
SimulateWOA <- function(W, alpha){
agents <- length(W)
winner <- which.max(W)
copy_W <- W
copy_W[winner] = 0
transfer <- unlist(lapply(W,Tau, N = agents))
social_welfare = sum(copy_W*alpha) + W[winner] - sum(transfer)
res = c(winner, W[winner], transfer[winner], sum(transfer), social_welfare)
return(res)
}
Simulatescenario <- function(W,alpha){
VCG <- SimulateVCG(W,alpha)
Random <- SimulateRandom(W,alpha)
WOA <- SimulateWOA(W,alpha)
res <- c(VCG[4], Random[3], WOA[5])
return(res)
}
max_agents = 50
SW_VCG = c()
SW_Random = c()
SW_WOA = c()
for (n in 1:max_agents){
data = c()
for (rep in 1:100){
N = n
W <- runif(N)
res <- Simulatescenario(W,alpha)
data <- rbind(data, res)
}
print(alpha*sum(W))
data_mean <- colMeans(data)
SW_VCG = c(SW_VCG, data_mean[1])
SW_Random = c(SW_Random, data_mean[2])
SW_WOA = c(SW_WOA, data_mean[3])
}
plot(1:max_agents,SW_VCG, col="blue", pch="o", lty=1, ylim = c(0, 10))
points(SW_Random, pch="x", col="red", lty=1)
points(SW_WOA, pch="+", col="green")
plot(1:max_agents,SW_VCG, col="blue", pch="o", lty=1, ylim = c(-1, 1))
points(SW_Random, pch="x", col="red", lty=1)
points(SW_WOA, pch="+", col="green")
alpha = -0.1
integ <-function(x,P){(P-1)*(x^(P-1))/(1 - (x^(P-1)))}
Tau <- function(w,N){
if(N==1){
return(0)
}
else{
return((1- alpha)*(integrate(integ, lower= 0, upper= w, P = N)$value))
}
}
SimulateVCG <- function(W, alpha){
winner <- which.max(W)
copy_W <- W
copy_W[winner] = 0
transfer <- (1- alpha)*max(copy_W)
social_welfare = sum(copy_W*alpha) + W[winner] - transfer
res = c(winner, W[winner], transfer, social_welfare)
return(res)
}
SimulateRandom <- function(W, alpha){
winner <- sample(1:length(W),1)
copy_W <- W
copy_W[winner] = 0
social_welfare = sum(copy_W*alpha) + W[winner]
res = c(winner, W[winner], social_welfare)
return(res)
}
SimulateWOA <- function(W, alpha){
agents <- length(W)
winner <- which.max(W)
copy_W <- W
copy_W[winner] = 0
transfer <- unlist(lapply(W,Tau, N = agents))
social_welfare = sum(copy_W*alpha) + W[winner] - sum(transfer)
res = c(winner, W[winner], transfer[winner], sum(transfer), social_welfare)
return(res)
}
Simulatescenario <- function(W,alpha){
VCG <- SimulateVCG(W,alpha)
Random <- SimulateRandom(W,alpha)
WOA <- SimulateWOA(W,alpha)
res <- c(VCG[4], Random[3], WOA[5])
return(res)
}
max_agents = 50
SW_VCG = c()
SW_Random = c()
SW_WOA = c()
for (n in 1:max_agents){
data = c()
for (rep in 1:100){
N = n
W <- runif(N)
res <- Simulatescenario(W,alpha)
data <- rbind(data, res)
}
print(alpha*sum(W))
data_mean <- colMeans(data)
SW_VCG = c(SW_VCG, data_mean[1])
SW_Random = c(SW_Random, data_mean[2])
SW_WOA = c(SW_WOA, data_mean[3])
}
plot(1:max_agents,SW_VCG, col="blue", pch="o", lty=1, ylim = c(-1, 1))
points(SW_Random, pch="x", col="red", lty=1)
points(SW_WOA, pch="+", col="green")
alpha = 0.1
max_agents = 50
SW_VCG = c()
SW_Random = c()
SW_WOA = c()
for (n in 1:max_agents){
data = c()
for (rep in 1:100){
N = n
W <- runif(N)
VCG <- SimulateVCG(W,alpha)
W <- runif(N)
Random <- SimulateRandom(W,alpha)
W <- runif(N)
WOA <- SimulateWOA(W,alpha)
res <- c(VCG[4], Random[3], WOA[5])
data <- rbind(data, res)
}
data_mean <- colMeans(data)
SW_VCG = c(SW_VCG, data_mean[1])
SW_Random = c(SW_Random, data_mean[2])
SW_WOA = c(SW_WOA, data_mean[3])
}
plot(1:max_agents,SW_VCG, col="blue", pch="o", lty=1, ylim = c(-1, 1))
points(SW_Random, pch="x", col="red", lty=1)
points(SW_WOA, pch="+", col="green")
plot(1:max_agents,SW_VCG, col="blue", pch="o", lty=1, ylim = c(-1, 10))
points(SW_Random, pch="x", col="red", lty=1)
points(SW_WOA, pch="+", col="green")
plot(1:max_agents,SW_VCG, col="blue", pch="o", lty=1, ylim = c(-1, 3))
points(SW_Random, pch="x", col="red", lty=1)
points(SW_WOA, pch="+", col="green")
clear
cklc
clc
setwd("C:/Users/franc/OneDrive/Escritorio/registros UC/Trabajos-Nico")
